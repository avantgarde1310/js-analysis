var last_logout_on_close=0;function onLoad(A){if(!A){get_data("prefs",function(){onLoad(true)});return}sr(document,"save","value","Save");sr(document,"cancel","value","Cancel");sr(document,"helptranslate","value","Help Translate");if((enable_native_idle&&typeof(chrome)!="undefined"&&typeof(chrome.idle)!="undefined")||((getBG().g_is_win||getBG().g_is_linux||getBG().g_is_mac)&&getBG().have_nplastpass())){document.getElementById("idlelogoffspan").style.display=""}else{if(!g_issafari&&!g_isopera){document.getElementById("idlelogoffneedbinaryspan").style.display=""
}}if((getBG().g_is_win||getBG().g_is_mac||getBG().g_is_linux)&&!getBG().LPISLOC&&!getBG().is_chrome_portable()){if(getBG().have_nplastpass()){document.getElementById("enablenamedpipesspan").style.display=""}else{if(!g_issafari&&!g_isopera){document.getElementById("enablenamedpipesneedbinaryspan").style.display=""}}}if(g_issafari){document.getElementById("appearancespan").style.display="none"}if(g_issafari||g_isopera){document.getElementById("shownotificationsspan").style.display="none";document.getElementById("showsavesitenotificationsspan").style.display="none"
}if(getBG().LPISLOC){document.getElementById("launchaccountsettings").style.display="none";document.getElementById("security_prompts").style.display=""}populate();var B=getBG().g_pref_tab;getBG().g_pref_tab=null;if(!B){B="general"}menuaction(B)}function check(A,C,B){document.getElementById(C).checked=A.lpGetPref(C,B)==1}function fillVal(A,C,B){document.getElementById(C).value=A.lpGetPref(C,B)}function setSelect(B,F,D){var C=document.getElementById(F);var E=B.lpGetPref(F,D);for(var A=0;A<C.options.length;
A++){if(E==C.options[A].value){C.selectedIndex=A;break}}}function showChromeLanguageError(){alert(gs("Google Chrome requires that extensions use the same language as the browser, so in order to switch LastPass's language, please change the main browser language under Chrome's Options."));document.getElementById("save").focus()}function populate(){createMenu();filldefaultffid();fillLanguage();var B=getBG();check(B,"disablecrpw",1);check(B,"logoffWhenCloseBrowser",0);check(B,"highlightFields",1);check(B,"automaticallyFill",1);
check(B,"showvault",0);check(B,"showAcctsInGroups",1);check(B,"donotoverwritefilledfields",0);check(B,"showNotifications",1);check(B,"showGenerateNotifications",1);check(B,"showFormFillNotifications",1);check(B,"showSaveSiteNotifications",0);check(B,"showNotificationsAfterClick",1);check(B,"showFillNotificationBar",1);check(B,"showSaveNotificationBar",1);check(B,"showChangeNotificationBar",1);check(B,"warninsecureforms",0);check(B,"dontfillautocompleteoff",0);check(B,"openloginstart",B.LPISUPEK?1:0);
check(B,"storeLostOTP",1);check(B,"enablenamedpipes",1);fillVal(B,"logoffWhenCloseBrowserVal","0");fillVal(B,"idleLogoffVal","");document.getElementById("idleLogoffEnabled").checked=parseInt(document.getElementById("idleLogoffVal").value)>0;fillVal(B,"autoautoVal","25");document.getElementById("autoautoEnabled").checked=parseInt(document.getElementById("autoautoVal").value)>0;fillVal(B,"pollServerVal","15");document.getElementById("pollServerEnabled").checked=parseInt(document.getElementById("pollServerVal").value)>0;
fillVal(B,"clearClipboardSecsVal","30");document.getElementById("clearClipboardSecsEnabled").checked=parseInt(document.getElementById("clearClipboardSecsVal").value)>0;check(B,"searchNotes",1);fillVal(B,"searchNotesVal","200");check(B,"recentUsed",1);fillVal(B,"recentUsedCount","10");document.getElementById("recentUsed").checked=parseInt(document.getElementById("recentUsedCount").value)>0;setSelect(B,"openpref","tabs");setSelect(B,"defaultffid","0");setSelect(B,"language","");last_logout_on_close=B.lpGetPref("logoffWhenCloseBrowser",0);
last_logout_on_close_val=B.lpGetPref("logoffWhenCloseBrowserVal",0);var C=new Array("generateHk","recheckHk","searchHk","nextHk","prevHk","homeHk","submitHk","saveallHk","logoffHk","defaultffidHk");for(var A=0;A<C.length;A++){var D=C[A];optionsData.HotKeys[D+"KeyCode"]=B.lpGetPref(D+"KeyCode");optionsData.HotKeys[D+"Mods"]=B.lpGetPref(D+"Mods");writeHotKeyValue(D)}document.getElementById("login_site_prompt").checked=B.g_prompts.login_site_prompt;document.getElementById("edit_site_prompt").checked=B.g_prompts.edit_site_prompt;
document.getElementById("edit_sn_prompt").checked=B.g_prompts.edit_sn_prompt;document.getElementById("view_pw_prompt").checked=B.g_prompts.view_pw_prompt;document.getElementById("view_ff_prompt").checked=B.g_prompts.view_ff_prompt}function filldefaultffid(){var B=document.getElementById("defaultffid");B.options[0]=new Option("","0",false,false);for(var A in getBG().g_formfills){if(getBG().check_ident_ffid(getBG().g_formfills[A].ffid)){B.options[B.options.length]=new Option(getBG().g_formfills[A].decprofilename,getBG().g_formfills[A].ffid,false,false)
}}}function fillLanguage(){var B=document.getElementById("language");for(var A in g_langs){B.options[B.options.length]=new Option(g_langs[A],A,false,false)}}function createMenu(){var D={general:{icon:"images/icon_lock.png",title:gs("General"),cmd:"general"},notifications:{icon:"images/icon_bell.png",title:gs("Notifications"),cmd:"notifications"},feedback:{icon:"images/icon_up-red.gif",title:gs("Feedback"),cmd:"feedback"},hotkeys:{icon:"images/keyboard.png",title:gs("HotKeys"),cmd:"hotkeys"},accountsettings:{icon:"icon.gif",title:gs("Account Settings"),cmd:"accountsettings"},advanced:{icon:"images/icon_preferences.png",title:gs("Advanced"),cmd:"advanced"}};
var C="";var B;var A;for(B in D){if(D[B]==null){C+='<div id="menu'+B+'" class="menuspacer"><div></div></div>';continue}A=typeof(D[B].cmd)=="undefined"?"":" onclick=\"menuaction('"+D[B].cmd+"')\"";C+='<div id="menu'+B+'" class="menubutton"'+A+'><div class="menubuttontext" style="background:url('+D[B].icon+') no-repeat 5px 3px;">'+D[B].title+"</div></div>"}$("#menu").html(C)}function ischecked(A){return document.getElementById(A).checked?1:0}function getVal(A){console_log(A);return document.getElementById(A).value
}function selectedValue(B){var A=document.getElementById(B);return A.options[A.selectedIndex].value}function dosave(O){var G=getBG();var N=false;var Q=new Array("generateHk","recheckHk","searchHk","nextHk","prevHk","homeHk","submitHk","saveallHk","logoffHk","defaultffidHk");var X=false;for(var V=0;V<Q.length-1;V++){var B=optionsData.HotKeys[Q[V]+"KeyCode"];if(typeof(B)=="undefined"||!B||B==""||B==0||B=="0"){continue}var K=optionsData.HotKeys[Q[V]+"Mods"];if(typeof(K)=="undefined"||!K||K==""){continue
}for(var T=V+1;T<Q.length;T++){var A=optionsData.HotKeys[Q[T]+"KeyCode"];if(typeof(A)=="undefined"||!A||A==""||A==0||A=="0"){continue}var H=optionsData.HotKeys[Q[T]+"Mods"];if(typeof(H)=="undefined"||!H||H==""){continue}if(A==B&&H==K){X=true;break}}if(X){break}}if(X){alert(gs("You cannot assign more than one HotKey the same value."));return false}var F=false;if(document.getElementById("login_site_prompt").checked!=G.g_prompts.login_site_prompt){F=true}if(document.getElementById("edit_site_prompt").checked!=G.g_prompts.edit_site_prompt){F=true
}if(document.getElementById("edit_sn_prompt").checked!=G.g_prompts.edit_sn_prompt){F=true}if(document.getElementById("view_pw_prompt").checked!=G.g_prompts.view_pw_prompt){F=true}if(document.getElementById("view_ff_prompt").checked!=G.g_prompts.view_ff_prompt){F=true}if(F&&!O){G.security_prompt(function(){dosave(true)});return}G.lpPutGblPref("disablecrpw",ischecked("disablecrpw"));var L=false;var C=G.g_prefoverrides;if(typeof(C.logoffclosebrowser)=="undefined"||C.logoffclosebrowser==-1){G.lpPutGblPref("logoffWhenCloseBrowser",ischecked("logoffWhenCloseBrowser"));
G.lpPutGblPref("logoffWhenCloseBrowserVal",getVal("logoffWhenCloseBrowserVal"))}else{if(ischecked("logoffWhenCloseBrowser")!=last_logout_on_close||getVal("logoffWhenCloseBrowserVal")!=last_logout_on_close_val){L=true}}var U=getVal("idleLogoffVal");if(document.getElementById("idleLogoffEnabled").checked){if(parseInt(U)<=0){U="15"}}else{U="0"}if(typeof(C.logoffidle)=="undefined"||C.logoffidle==-1){G.lpPutUserPref("idleLogoffVal",U)}else{if(U!=C.logoffidle){L=true}}if(L){alert(gs("Company policy prevents changing some settings, not all updates have been saved."))
}G.lpPutUserPref("highlightFields",ischecked("highlightFields"));G.lpPutUserPref("automaticallyFill",ischecked("automaticallyFill"));G.lpPutGblPref("showvault",ischecked("showvault"));G.lpPutUserPref("showAcctsInGroups",ischecked("showAcctsInGroups"));G.lpPutUserPref("donotoverwritefilledfields",ischecked("donotoverwritefilledfields"));G.lpPutUserPref("showNotifications",ischecked("showNotifications"));G.lpPutUserPref("showGenerateNotifications",ischecked("showGenerateNotifications"));G.lpPutUserPref("showFormFillNotifications",ischecked("showFormFillNotifications"));
G.lpPutUserPref("showSaveSiteNotifications",ischecked("showSaveSiteNotifications"));G.lpPutUserPref("showNotificationsAfterClick",ischecked("showNotificationsAfterClick"));G.lpPutUserPref("showFillNotificationBar",ischecked("showFillNotificationBar"));G.lpPutUserPref("showSaveNotificationBar",ischecked("showSaveNotificationBar"));G.lpPutUserPref("showChangeNotificationBar",ischecked("showChangeNotificationBar"));var W=getVal("autoautoVal");if(document.getElementById("autoautoEnabled").checked){if(parseInt(W)<=0){W="25"
}else{if(parseInt(W)<10){W="10"}}}else{W="0"}G.lpPutUserPref("autoautoVal",W);G.lpPutUserPref("warninsecureforms",ischecked("warninsecureforms"));G.lpPutUserPref("dontfillautocompleteoff",ischecked("dontfillautocompleteoff"));var P=getVal("pollServerVal");if(document.getElementById("pollServerEnabled").checked){if(parseInt(P)<=0){P="15"}else{if(parseInt(P)<5){P="5"}}}else{P="0"}G.lpPutUserPref("pollServerVal",P);var S=getVal("clearClipboardSecsVal");if(document.getElementById("clearClipboardSecsEnabled").checked){if(parseInt(S)<=0){S="30"
}}else{S="0"}G.lpPutUserPref("clearClipboardSecsVal",S);G.lpPutUserPref("searchNotes",ischecked("searchNotes"));G.lpPutUserPref("searchNotesVal",getVal("searchNotesVal"));G.lpPutUserPref("recentUsed",ischecked("recentUsed"));if(ischecked("recentUsed")){G.lpPutUserPref("recentUsedCount",parseInt(getVal("recentUsedCount")))}else{G.lpPutUserPref("recentUsedCount","0")}G.lpPutGblPref("openloginstart",ischecked("openloginstart"));G.lpPutGblPref("storeLostOTP",ischecked("storeLostOTP"));G.lpPutUserPref("storeLostOTP",ischecked("storeLostOTP"));
var J=G.lpGetPref("enablenamedpipes",1);var E=ischecked("enablenamedpipes");if(E!=J){N=true}G.lpPutGblPref("enablenamedpipes",E);G.lpPutUserPref("openpref",selectedValue("openpref"));G.lpPutUserPref("defaultffid",selectedValue("defaultffid"));var M=G.lpGetPref("language","");var Y=selectedValue("language");if(M!=Y){N=true}G.lpPutGblPref("language",Y);var D=last_logout_on_close==1&&last_logout_on_close_val==0;var I=ischecked("logoffWhenCloseBrowser")&&getVal("logoffWhenCloseBrowserVal")==0;if(I!=D){alert(gs("You must restart Chrome or logoff and back in to get logoff on browser close changes to be reflected"))
}if(!ischecked("storeLostOTP")){G.DeleteOTP()}for(var V=0;V<Q.length;V++){var R=Q[V];G.lpPutGblPref(R+"KeyCode",optionsData.HotKeys[R+"KeyCode"]);G.lpPutGblPref(R+"Mods",optionsData.HotKeys[R+"Mods"])}if(F){G.g_prompts.login_site_prompt=document.getElementById("login_site_prompt").checked;G.g_prompts.edit_site_prompt=document.getElementById("edit_site_prompt").checked;G.g_prompts.edit_sn_prompt=document.getElementById("edit_sn_prompt").checked;G.g_prompts.view_pw_prompt=document.getElementById("view_pw_prompt").checked;
G.g_prompts.view_ff_prompt=document.getElementById("view_ff_prompt").checked;if(g_issafari||g_isopera){G.update_prompts()}G.rewritelocalfile()}if(ischecked("logoffWhenCloseBrowser")||ischecked("idleLogoffEnabled")){if(G.lpGetPref("rememberpassword",-1)==1||G.g_master_password_saved){if(confirm(gs("You currently have LastPass set to remember your password.  Doing so essentially makes the automatically logoff options you've chosen useless.  Would you like LastPass to stop remembering your password?"))){G.lpPutGblPref("rememberpassword",0);
G.deletesavedpw(G.g_username)}}}if(N){alert(gs("You must restart your browser before all of the changes will take effect."))}G.lpWriteAllPrefs();G.start_idle_checker();G.setprefs("all","all");if(g_issafari||g_isopera){G.update_prefs("prefs")}setTimeout(function(){getBG().closecurrenttab("prefs.html")},0)}function docancel(){setTimeout(function(){getBG().closecurrenttab("prefs.html")},0)}function openfeedback(){var A=getBG();if(A){A.openURL(A.base_url+"feedback.php")}setTimeout(function(){window.close()
},0)}function openaccountsettings(){var A=getBG();if(A){A.openURL(A.base_url+"?ac=1&opensettings=1")}setTimeout(function(){window.close()},0)}function openhelptranslate(){var A=getBG();if(A){A.openURL(A.base_url+"translate.php")}setTimeout(function(){window.close()},0)}function getbinary(){var A=getBG();if(A){A.openURL(A.base_url+"lpchrome_bin.crx")}setTimeout(function(){window.close()},0)}var tabs=new Array("general","notifications","feedback","hotkeys","accountsettings","advanced");function menuaction(C){for(var B in tabs){var A=tabs[B];
document.getElementById("menu"+A).className="menubutton";document.getElementById(A).style.display="none"}document.getElementById("menu"+C).className="menubutton2";document.getElementById(C).style.display=""};