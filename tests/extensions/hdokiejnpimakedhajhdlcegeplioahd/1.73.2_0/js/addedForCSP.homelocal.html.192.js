var gLastLoginState=0;var gAccts_version=-1;var gCurr_username="";var gTimerId=null;var gIconsLength=0;var gLastSearch="";var gIdentity="";var gSearchWhileType=true;var gTreeHeightOffset=147;var gPollInterval=500;var gHidePreferences=false;function fix_group(A){if(A==gs("(none)")){A=""}return A}function onLoad(B,A){try{if(typeof(g_is_safari)!="undefined"&&typeof(LPFromWebsite)=="undefined"){if(B<50){B++;setTimeout(function(){onLoad(B)},25)}else{document.location.href=document.location.href}return
}if(typeof(g_is_safari)=="undefined"&&!A){get_data("vault",function(){onLoad(B,true)});return}if(isSafariNative()&&typeof(LPFromWebsite.ipad)=="function"){gTreeHeightOffset=180;gPollInterval=1500;gSearchWhileType=false;gHidePreferences=true;document.getElementById("identitycontainer").style.display="none";document.getElementById("accountsettingscontainer").style.display="none";document.getElementById("fillformscontainer").style.display="none"}if(getBG().LPISLOC){document.getElementById("accountsettingscontainer").style.display="none"
}if(getBG().g_hideidentities){document.getElementById("identitycontainer").style.display="none"}sr(document,"submit","value","Search");sr(document,"clear","value","Clear");document.getElementById("fillformstext").innerHTML=gs("Fill Forms");document.getElementById("addsecurenotetext").innerHTML=gs("Add Secure Note");document.getElementById("logintext").innerHTML=gs("Login");document.getElementById("identitylabel").innerHTML=gs("Identity");document.getElementById("accountsettings").innerHTML=gs("Account Settings");
document.getElementById("moretext").innerHTML=gs("More");document.getElementById("namepropertext").innerHTML=(isSafariNative()?gs("Name"):gs("Nameproper"));document.getElementById("actionpropertext").innerHTML=(isSafariNative()?gs("Action"):gs("Actionproper"));document.getElementById("usernamepropertext").innerHTML=(isSafariNative()?gs("Username"):gs("Usernameproper"));document.getElementById("logofflink").innerHTML=gs("Logoff");document.getElementById("expandall").innerHTML=gs("Expand All");document.getElementById("collapseall").innerHTML=gs("Collapse All");
document.getElementById("creategroup").innerHTML=gs("Create Group");document.getElementById("nositestext").innerHTML=gs("To get started with LastPass, you will need to add sites to your account.")+"<br/>"+gs("Browse the web as you normally would and LastPass will automatically remember passwords as you enter them.")+"<br/><a href='#' onclick='getBG().openbaseurl(\"basic.php\"); return false;' target='_blank'>"+gs("Watch a video on basic usage");document.getElementById("adframe").style.width="0px";
document.getElementById("thetree").style.width=(document.body.clientWidth-2)+"px";document.getElementById("thetree").style.height=(document.body.clientHeight-gTreeHeightOffset)+"px";gTimerId=setInterval("checkLoggedInHome()",gPollInterval);create_combo("grpsel",new Array());document.getElementById("grpsel_combo").style.height="150px";document.getElementById("grpsel_combo").style.overflow="auto";if(getcolvisibility("usernamecol")){document.getElementById("usernamepropertext").className="usercolvisible"
}document.getElementById("q").focus()}catch(C){alert(C)}}function onUnload(){if(gTimerId){clearInterval(gTimerId);gTimerId=null}saveGroupState()}function onResize(){document.getElementById("thetree").style.width=(document.body.clientWidth-2)+"px";document.getElementById("thetree").style.height=(document.body.clientHeight-gTreeHeightOffset)+"px";if(typeof(myScroll)!="undefined"){myScroll.refresh()}}function checkLoggedInHome(B){try{var D=getBG();var A=D.lploggedin;if(isSafariNative()){LPFromWebsite.lpupdateState(D.g_username,A,D.g_local_accts_version,D.g_identity,D.g_isadmin)
}else{if((typeof(g_issafari)!="undefined"&&g_issafari)||(typeof(g_isopera)!="undefined"&&g_isopera)){if(!B){D.update_state("vault");return}}}var G="";if(A){G=D.g_username}if(A!=gLastLoginState||G!=gCurr_username){if(A){window_load_loggedin(G)}else{try{var E=new Object();E["static"]="{}";$(function(){$("#thetree").tree({data:{type:"json",opts:E}})})}catch(F){}g_rootnodeid=null;g_lastnodeid=null;window_load_loggedoff()}}gLastLoginState=A;gCurr_username=G;if(gLastLoginState){var C=D.g_local_accts_version;
if(C>gAccts_version||D.IsIconsUpdated(gIconsLength)||D.g_identity!=gIdentity){gAccts_version=C;populateNewData(gLastSearch);update_identity_popup()}}}catch(F){alert(F)}}function window_load_loggedin(A){document.getElementById("username").innerHTML=A;document.getElementById("formfilllink").disabled=0;document.getElementById("securenotelink").disabled=0;document.getElementById("identity").disabled=0;document.getElementById("accountsettings").disabled=0;document.getElementById("moremenu").disabled=0;
document.getElementById("logofflink").disabled=0;showhide("expandrow",true);showhide("treeheader",true);showhide("treerow",true)}function window_load_loggedoff(){gAccts_version=-1;gIconsLength=0;gLastSearch="";document.getElementById("username").innerHTML="<b><a href='' onclick='return login();'>"+gs("Login")+"</a></b>";document.getElementById("formfilllink").disabled=1;document.getElementById("securenotelink").disabled=1;document.getElementById("identity").disabled=1;document.getElementById("accountsettings").disabled=1;
document.getElementById("moremenu").disabled=1;document.getElementById("logofflink").disabled=1;showhide("nosites",false);showhide("expandrow",false);showhide("treeheader",false);showhide("treerow",false)}function populateNewData(A){if(isSafariNative()){LPFromWebsite.lpgetaccts()}else{populate(A)}}function isSafariNative(){return(typeof(LPFromWebsite)!="undefined"&&(typeof(g_issafari)=="undefined"||!g_issafari))}function showhide(B,A){document.getElementById(B).style.display=(A?"":"none")}function update_identity_popup(){var C=getBG();
var A=document.getElementById("identity");while(A.length){A.remove(0)}var D=document.createElement("option");D.text=gs("All");D.value="";if(C.g_identity==""){D.selected=1}A.appendChild(D);for(var B in C.g_identities){var D=document.createElement("option");D.text=C.g_identities[B].deciname;D.value=C.g_identities[B].iid;if(C.g_identity==C.g_identities[B].iid){D.selected=1}A.appendChild(D)}}function populate(H){try{var C=getBG();var J=C.get_searchNotesB64Length();gLastSearch=H;gIconsLength=C.g_icons_length;
gIdentity=C.g_identity;var Q=new Array();var V=new Array();var O=new Array();var X=new Array();var G=0;var P=[C.g_sites,C.g_securenotes];for(var N in P){var K=P[N];for(var E in K){G++;if(!C.check_ident_aid(E)){continue}var I=K[E];if(H&&H!=""&&!matches(I,H,J)){continue}var F=I.group!=""?I.group:gs("(none)");if(typeof(Q[F])=="undefined"){Q[F]=new Array();V[V.length]=F}Q[F][Q[F].length]=I;X[X.length]=I;if(I.fav=="1"){O[O.length]=I}}}for(var S in C.g_pendings){var I=C.g_pendings[S];if(H!=""){continue
}var F=gs("(New Pending Share Offers)");if(typeof(Q[F])=="undefined"){Q[F]=new Array();V[V.length]=F}Q[F][Q[F].length]=I}if(G==0){if(gAccts_version>=0){document.getElementById("nosites").style.display=""}try{var M=new Object();M["static"]="{}";$(function(){$("#thetree").tree({data:{type:"json",opts:M}})})}catch(T){}gAccts_version=-1;return}else{document.getElementById("nosites").style.display="none"}V.sort(function(c,Z){return c.toLowerCase()<Z.toLowerCase()?-1:1});X.sort(function(c,Z){return c.last_touch>Z.last_touch?1:-1
});var R=new Array();var A=C.getClearRecentTime();var W=C.getRecentCount();if(H==""){for(var S=0;R.length<W&&S<X.length;S++){if(X[X.length-S-1].url=="http://group"){continue}if(X[X.length-S-1].last_touch<A){continue}R[R.length]=X[X.length-S-1]}}if(R.length){var X=(isSafariNative()?"recently used":"recently usedlower");var D=gs(X);V.unshift(D);Q[D]=R}if(O.length){V.unshift(gs("favorites"));Q[gs("favorites")]=O}var L=[];if(H==""){L=getOpenedGroups()}var Y=[];var B=[];for(var S=0;S<V.length;S++){var U=false;
if(H!=""||typeof(L[V[S]])!="undefined"){U=true}addGroup(C,Q,Y,B,V[S],U,"",false)}$(function(){var Z=new Object();Z["static"]=Y;$("#thetree").tree({callback:{beforedelete:lpbeforedelete,beforemove:lpbeforemove,onmove:lponmove,check_move:lpcheck_move,onrgtclk:lponrgtclk},data:{type:"json",opts:Z},rules:{multiple:"ctrl",drag_copy:false,use_max_children:false,use_max_depth:false},plugins:{hotkeys:{functions:{"return":function(){var a=$.tree.focused().selected;if(a&&a.length==1&&isNumber(a[0].id)){ls(a[0].id)
}}}}}})})}catch(T){if(typeof(LPFromWebsite)=="undefined"||typeof(LPFromWebsite.ipad)!="function"){alert(T)}}update_identity_popup()}function lpbeforedelete(C,J){var F=getBG();var I=$.tree.focused().selected_arr&&$.tree.focused().selected_arr.length;if(I>1){var B="";var H=new Array();for(var G=0;G<$.tree.focused().selected_arr.length;G++){var D=getmoveid($.tree.focused().selected_arr[G]);if(D&&D!=""){B+=(B!=""?",":"")+D;H[H.length]=$.tree.focused().selected_arr[G]}}F.deleteAid(B,window,false,false,function(){for(var K=0;
K<H.length;K++){$.tree.focused().cut(H[K])}});return false}else{var E=isNumber(C.id)?true:false;var A=false;if(E){A=F.deleteAid(C.id,window,false,false,function(){$.tree.focused().cut(C)})}else{A=F.deleteGroup(fix_group(C.id),window,function(){$.tree.focused().cut(C)})}return A}}function lpbeforemove(P,F,E,K){var H="";var B=F;var R=0;while(B&&B.attr("id")==""&&R<100){B=B.parent();R++}if(R>99||!B){return false}var N=B.attr("id");var H="";var C=getBG();if(isNumber(N)){var M=[C.g_sites,C.g_securenotes];
for(var L in M){var J=M[L];for(var G in J){var I=J[G];if(I.aid==N){if(I.fav=="1"){var O=B.parent();R=0;while(O&&O.attr("id")==""&&R<100){O=O.parent();R++}if(R<99&&O){if(O.attr("id")==gs("favorites")){H=gs("favorites");break}}}H=I.group;break}}}}else{var S=N.lastIndexOf("\\");if(S!=-1){N=N.substr(0,S)}H=N}var T=(isSafariNative()?"recently used":"recently usedlower");var D=gs(T);if(H==""||H==T){return}var A=$.tree.focused().selected_arr;var U="";for(var Q=0;Q<A.length;Q++){if(isNumber(getmoveid(A[Q]))){U+=(U==""?"":",")+getmoveid(A[Q])
}}if(U.length==0){U=P.attr("id")}if(U.length!=0){getBG().moveSelectedToGroup(H,U)}return false}function lponmove(E,D,C,B,A){}function lpcheck_move(D,C,B,A){if($.tree.focused().selected_arr.length>1){return true}if(D&&D.attr("id")!=""&&!isNumber(D.attr("id"))){return false}return true}function isNumber(A){return !isNaN(parseFloat(A))&&isFinite(A)}var g_rootnodeid=null;var g_lastnodeid=null;function addGroup(n,B,I,R,O,K,D){while(O[0]=="\\"){O=O.substr(1)}var l=O.match(/^([^\\]*)\\(.*)$/);var o=(l!=null);
var J="";var F=0;while(l&&!D){var G=l[1];var L=l[2];J+=(J!=""?"\\":"")+G;if(typeof(R[J])=="undefined"){addGroup(n,B,I,R,J,K,true)}F++;l=L.match(/^([^\\]*)\\(.*)$/)}J=(J==""?"":"\\")+O;var M=[];var q=(K?"open":"closed");var U=B[O];if(typeof(U)=="undefined"){U=new Array()}var A=(isSafariNative()?"recently used":"recently usedlower");var C=gs(A);if(O!=C&&O!=gs("(New Pending Share Offers)")){U.sort(n.lp_sort_case_insensitive_name)}else{U.sort(function(j,i){return j.last_touch>i.last_touch?-1:1})}var Q=getcolvisibility("usernamecol");
var Y=navigator.userAgent.match("Gecko/");for(var f=0;f<U.length;f++){var g=20+(F*15);if(Y){g+=20}var c=U[f];if(c.url=="http://group"){continue}var S="";var Z="";var H="<span style='clear:both'></span>";if(typeof(c.sharerusername)!="undefined"){if(typeof(g_isopera)!="undefined"&&g_isopera){S+="</a>"}S+="<div class='actionmenu' style='padding-right: "+g+"px;display:inline;'><a href='#' onclick='return accept(\""+c.id+"\")' style='text-decoration: underline; color: #00C'>"+gs("Accept")+"</a> | <a href='#' onclick='return reject(\""+c.id+"\")' style='text-decoration: underline; color: #00C'>"+gs("Reject")+"</a></div>";
S+=H;S+="<span><a href='#' onclick='return accept(\""+c.id+"\")'>"+gs("Share offer from")+" "+of(n.hex2bin(c.sharerusername))+"</a></span>"}else{Z=c.aid;var k;var E="<a href='#' onclick='return s(\""+c.aid+"\")' style='text-decoration: underline; color: #00C'>"+gs("Share")+"</a> | ";if(!n.LPISLOC&&!c.genpw&&(typeof(c.sharedfromaid)=="undefined"||c.sharedfromaid==null||c.sharedfromaid==""||c.sharedfromaid=="0"||c.sharedfromaid=="null")){k=""}else{k='<div style="visibility: hidden;display:inline;">'+E+"</div>";
E=""}if(typeof(g_isopera)!="undefined"&&g_isopera){S+="</a>"}S+="<div class='actionmenu' style='padding-right: "+g+"px; display: inline;'>"+k;if(isSafariNative()&&typeof(LPFromWebsite.ipad)=="function"){var p="",m="";if(c.url=="http://sn"||(typeof(c.sharedfromaid)!="undefined"&&c.sharedfromaid!=null&&c.sharedfromaid!=""&&c.sharedfromaid!="0"&&c.sharedfromaid!="null")){p='<div style="visibility: hidden;display:inline;">';m="</div>"}S+=p+"<a href='#' onclick='return cu(\""+c.aid+"\")' style='text-decoration: none; color: #00C'><img src='copyusername.png'></a>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<a href='#' onclick='return cp(\""+c.aid+"\")' style='text-decoration: none; color: #00C'><img src='copypassword.png'></a>&nbsp;&nbsp;&nbsp;|"+m
}S+="<a href='#' onclick='return e(\""+c.aid+"\")' style='text-decoration: underline; color: #00C'>"+gs("Edit")+"</a> | ";S+=E;S+="<a href='#' onclick='return d(\""+c.aid+"\")' style='text-decoration: underline; color: #00C'>"+gs("Delete")+"</a></div>";S+=H;S+="<span><a href='#' onclick='return ls(\""+c.aid+"\")'>"+of(c.name)+"</a></span>"}var T=Q?"usercolvisible":"usercolhidden";S+="<div style='float: right; padding-right: "+g+"px;' class='"+T+"' name='usercol'>"+of(n.getusernamefromacct(c))+"</div>";
var N=typeof(c.fiid)!="undefined"&&c.fiid!=""?c.fiid:c.aid;M[M.length]={data:{title:S,icon:n.geticonurl(N,c.url=="http://sn")},attributes:{onclick:"lc(event, this); return false;",id:Z}}}var X="";if(isSafariNative()&&typeof(LPFromWebsite.ipad)=="function"){X="onclick='$.tree.focused().toggle_branch(this)'"}var S="<span style='font-weight:bold' "+X+">"+of(O)+"</span>";R[O]=I.length;if(!o){if(I.length==0){g_rootnodeid=O}g_lastnodeid=O;I[I.length]={data:S,children:M,state:q,group:O,attributes:{id:of(J)}}
}else{var l=O.match(/^([^\\]*)\\(.*)$/);var V=null;var P=0;var W=0;while(l){var G=l[1];var L=l[2];if(P==0){for(var h=I.length-1;h>=0;h--){if(I[h].group==G){V=I[h]["children"];break}}W=0;P=1;if(!L.match(/^([^\\]*)\\(.*)$/)){for(var h=0;h<V.length;h++){if(typeof(V[h].group)=="undefined"||V[h].group==G){W=h;break}}}}else{var a=0;for(var h=0;h<V.length;h++){if(typeof(V[h].group)=="undefined"){a=h-1;break}else{if(V[h].group==G){a=h;break}}}V=V[a]["children"]}l=L.match(/^([^\\]*)\\(.*)$/)}var S="<span style='font-weight:bold'>"+L+"</span>";
V.splice(W,0,{data:S,children:M,state:q,group:L,attributes:{id:of(O)}})}}function getcolvisibility(B){var A;if(typeof(LPFromWebsite)=="undefined"||typeof(LPFromWebsite.ipad)=="function"){A=localStorage.getItem(B)}else{A=LPFromWebsite.getcolvisibility(B)}if(!A||A==0){return false}return true}function setcolvisibility(A,B){if(typeof(LPFromWebsite)=="undefined"||typeof(LPFromWebsite.ipad)=="function"){localStorage.setItem(A,B)}else{LPFromWebsite.setcolvisibility(A,B)}}function matches(E,B,A){var D=B.toLowerCase();
if(E.name.toLowerCase().indexOf(D)!=-1||(E.url&&E.url.toLowerCase().indexOf(D)!=-1)||E.group.toLowerCase().indexOf(D)!=-1||(E.unencryptedUsername&&E.unencryptedUsername.toLowerCase().indexOf(D)!=-1)){return true}if(A>0&&typeof(E.extra)!="undefined"&&E.extra.length>0&&E.extra.length<A){var C=getBG().lpmdec(E.extra,true);if(C.toLowerCase().indexOf(D)!=-1){return true}}return false}function getOpenedGroups(){var D=getBG();var B=new Array();var A="";if(typeof(LPFromWebsite)=="undefined"){if(typeof(localStorage)=="undefined"){return B
}var E=localStorage.getItem(D.db_prepend(D.g_username_hash+".savedtree"));A=D.dec(E)}else{A=LPFromWebsite.readopengroups()}if(!A||A==""){return B}var F=A.split(",");for(var C=0;C<F.length;C++){B[F[C].replace("%2C",",")]=1}return B}function saveGroupState(){var C=getBG();if(massoperation||!C.lploggedin){return}var B="";var D=$("#thetree").find(".open");$.each(D,function(F,G){var E=G.id;E.replace(",","%2C");B+=E+","});if(typeof(LPFromWebsite)=="undefined"){if(typeof(localStorage)=="undefined"){return
}var A=C.enc(B);localStorage.setItem(C.db_prepend(C.g_username_hash+".savedtree"),A)}else{LPFromWebsite.saveopengroups(B)}}function lc(B,A){$.tree.focused().select_branch(A,B.ctrlKey,B.shiftKey)}function lponopen(B,A){saveGroupState()}function lponclose(B,A){saveGroupState()}function lponrgtclk(H,B,G){var F=$.tree.focused().selected_arr&&$.tree.focused().selected_arr.length;if(F>1){var C="";var D=new Array();for(var A=0;A<$.tree.focused().selected_arr.length;A++){var E=getmoveid($.tree.focused().selected_arr[A]);
if(E&&E!=""){C+=(C!=""?",":"")+E;D[D.length]=$.tree.focused().selected_arr[A]}}setTimeout(function(){var I=$.contextMenu.create(function(){var J=getBG();var K={};K[gs("Move Selected to Group")]=function(){openMoveGroup(H)};K[gs("Share Selected")]=function(){s(C)};K[gs("Delete Selected")]=function(){J.deleteAid(C,window,false,false,function(){for(var L=0;L<D.length;L++){$.tree.focused().cut(D[L])}})};return[K]},{theme:"vista"});I.show(B,G)},100)}else{if(H.id!=""&&!isNumber(H.id)){setTimeout(function(){var I=$.contextMenu.create(function(){var J=getBG();
var L={};var K=(isSafariNative()?"recently used":"recently usedlower");var M=gs(K);if(H.id!=gs("favorites")&&H.id!=M&&H.id!=gs("(New Pending Share Offers)")){L[gs("Rename Group")]=function(){openMoveGroup(H)};L[gs("Delete Group")]=function(){J.deleteGroup(fix_group(H.id),window,function(){$.tree.focused().cut(H)})};L[gs("Create Sub-Group")]=function(){openCreateGroup(H)}}L[gs("Open All")]=function(){J.openall(H.id)};return[L]},{theme:"vista"});I.show(B,G)},0);G.preventDefault()}else{if(H.id!=""&&isNumber(H.id)){setTimeout(function(){var I=$.contextMenu.create(function(){var J=getBG();
var K={};if((typeof(g_issafari)=="undefined"&&typeof(g_isopera)=="undefined")||(!g_issafari&&!g_isopera)||typeof(g_is_safari)!="undefined"){K[gs("Copy Username")]=function(){J.copyusername(H.id)};K[gs("Copy Password")]=function(){J.copypassword(H.id)}}K[gs("Move to Group")]=function(){openMoveGroup(H)};K[gs("Move to Sub-Group")]=function(){openMoveGroup(H,true)};K[gs("Share")]=function(){s(H.id)};K[gs("Delete")]=function(){J.deleteAid(H.id,window,false,false,function(){$.tree.focused().cut(H)})};
K[gs("Edit")]=function(){J.editAid(H.id,window)};K[gs("Go to URL")]=function(){J.gotourl(H.id,null)};return[K]},{theme:"vista"});I.show(B,G)},100)}}}G.preventDefault()}function SearchTree(){var A=$("#q").val();populate(A)}function ls(B){var A=getBG();A.launch(B);return false}function cu(B){var A=getBG();A.copyusername(B);return false}function cp(B){var A=getBG();A.copypassword(B);return false}function e(B){var A=getBG();A.editAid(B,window);return false}function d(B){var A=getBG();A.deleteAid(B,window);
return false}function s(B){var A=getBG();A.openbaseurl("?ac=1&share="+A.en(B));return false}function MoveFocus(A){if(A.keyCode==40||A.keyCode==34||A.keyCode==38||A.keyCode==33){var B=A.keyCode==38||A.keyCode==33?g_lastnodeid:g_rootnodeid;$.tree.focused().select_branch("#"+B);document.getElementById("q").blur()}}function clearTree(){populate("")}var massoperation=false;function expandall(){var A=getBG();if(!A.lploggedin){return false}massoperation=true;$.tree.focused().open_all();massoperation=false;
saveGroupState()}function collapseall(){var A=getBG();if(!A.lploggedin){return false}massoperation=true;$.tree.focused().close_all();massoperation=false;saveGroupState()}function creategroup(){var A=getBG();if(!A.lploggedin){return}openCreateGroup(null)}function showformfill(B,C){var A=getBG();if(!A.lploggedin){A.open_login(1);return false}setTimeout(function(){var D=$.contextMenu.create(function(){var G=getBG();var I={};for(var F in G.g_formfills){var E=G.g_formfills[F].ffid;if(G.check_ident_ffid(E)){I[G.g_formfills[F].decprofilename]=function(J){editff(J.innerText)
}}}var H={};H[gs("Add Profile")]=function(){getBG().addprofile()};H[gs("Add Credit Card")]=function(){getBG().addcreditcard()};return[I,"context-menu-separator",H]},{theme:"vista"});D.show(B,C)},0);return false}function editff(C){var B=getBG();C=$.trim(C);for(var A in B.g_formfills){if(C==B.g_formfills[A].decprofilename){B.editprofile(B.g_formfills[A].ffid);break}}}function showmoremenu(B,C){var A=getBG();if(!A.lploggedin){A.open_login(1);return false}setTimeout(function(){var D=$.contextMenu.create(function(){var E={};
if(!gHidePreferences){E[gs("Preferences")]=function(){getBG().openprefs()}}if(!getBG().LPISLOC){E[gs("History")]=function(){getBG().openbaseurl("?ac=1&openhistory=1")};E[gs("Show Deleted Sites")]=function(){getBG().openbaseurl("?ac=1&showdeleted=1")}}if(!getBG().LPISLOC||!getBG().LPISUPEK){E[gs("Change Password")]=function(){getBG().changemasterpassword()}}E[gs("Forums")]=function(){getBG().openURL("http://forums.lastpass.com")};E[gs("Blog")]=function(){getBG().openURL("http://blog.lastpass.com")
};if(getBG().g_isadmin){E[gs("Admin Tools")]=function(){getBG().openbaseurl("admintools/")}}return[E]},{theme:"vista"});D.show(B,C)},0);return false}function addsecurenote(){getBG().openaddsecurenote();return false}function openaccountsettings(){var A=getBG();if(!A.lploggedin){A.open_login(1);return false}A.openbaseurl("?ac=1&opensettings=1");return false}function logoff(){var A=getBG();if(!A.lploggedin){return false}saveGroupState();getBG().loggedOut(false,"homelocal");return false}function accept(B){var A=getBG();
A.openbaseurl("?ac=1&acceptshare="+A.en(B));return false}function reject(B){var A=getBG();A.openbaseurl("?ac=1&rejectshare="+A.en(B));return false}function login(){getBG().open_login(true);return false}function changeidentity(A){getBG().switch_identity(A);document.getElementById("identity").value=getBG().g_identity}var gMoveSelected=null;function openMoveGroup(D,K){gMoveSelected=$.tree.focused().selected_arr;if(typeof(gMoveSelected)=="undefined"||gMoveSelected.length==0){gMoveSelected=new Array(D)
}var F=getBG();var C=new Array();var E=new Array();var I=[F.g_sites,F.g_securenotes];var G="";for(var L in I){var A=I[L];for(var B in A){var H=A[B];if(gMoveSelected&&gMoveSelected.length==1&&getmoveid(gMoveSelected[0])==B){G=H.group}var J=H.group!=""?H.group:gs("(none)");if(typeof(E[J])=="undefined"){E[J]="1";C[C.length]=J}}}C.sort(function(N,M){return N.toLowerCase()<M.toLowerCase()?-1:1});document.getElementById("grpsel").value="";repopulate_combo("grpsel",C);document.getElementById("dialog").title=gs("Change Group Name");
document.getElementById("dialogtext").innerHTML=gs("Select or enter a new group name");document.getElementById("dialoggrpinp").style.display="none";document.getElementById("dialoggrpsel").style.display="";document.getElementById("dosubgroup").value=(typeof(K)!="undefined"&&K?"1":"0");$("#dialog").dialog({autoOpen:false,bgiframe:true,modal:true,width:300,minWidth:300,minHeight:250,buttons:{Change:function(){if(gMoveSelected.length==1&&getmoveid(gMoveSelected[0])!=""&&!isNumber(getmoveid(gMoveSelected[0]))){getBG().renameGroup(fix_group(getmoveid(gMoveSelected[0])),fix_group(document.getElementById("grpsel").value))
}else{var M="";for(var N=0;N<gMoveSelected.length;N++){if(isNumber(getmoveid(gMoveSelected[N]))){M+=(M==""?"":",")+getmoveid(gMoveSelected[N])}}if(M.length==0){return}else{var O=document.getElementById("grpsel").value;if(gMoveSelected.length==1&&document.getElementById("dosubgroup").value=="1"){O=G+"\\"+O}getBG().moveSelectedToGroup(O,M)}}populate(gLastSearch);$(this).dialog("close")},Close:function(){$(this).dialog("close")}}});$("#dialog").dialog("open");$("#grpsel").click()}var selected_global;
function openCreateGroup(A){selected_global=A;document.getElementById("dialog").title=gs("Group Name");document.getElementById("dialogtext").innerHTML=gs("Group Name");document.getElementById("dialoggrpinp").style.display="";document.getElementById("grpinp").value="";document.getElementById("dialoggrpsel").style.display="none";$("#dialog").dialog({autoOpen:false,bgiframe:true,modal:true,width:300,minWidth:300,minHeight:250,buttons:{OK:function(){var G=document.getElementById("grpinp").value;if(selected_global!=null){G=fix_group(getmoveid(selected_global))+"\\"+G
}var C=getBG();var F=[C.g_sites,C.g_securenotes];for(var D in F){var B=F[D];for(var E in B){var H=B[E];if(H.group==G){alert(gs("That group already exists."));$(this).dialog("close");return}}}C.addEmptyGroup(G);populate(gLastSearch);$(this).dialog("close")},Close:function(){$(this).dialog("close")}}});$("#dialog").dialog("open");$("#grpinp").click()}function getmoveid(A){if(typeof(A.id)!="undefined"){return A.id}return A.attr("id")}function getacct(G){var B=getBG();if(isNumber(G)){var E=[B.g_sites,B.g_securenotes];
for(var C in E){var A=E[C];for(var D in A){var F=A[D];if(F.aid==G){return F}}}}return null}function getDragHTMLForNode(D){var C=D;var B=0;while(C&&C.attr("id")==""&&B<100){C=C.parent();B++}var A=getBG();var G=C.attr("id");var F=getacct(G);if(F){var E=typeof(F.fiid)!="undefined"&&F.fiid!=""?F.fiid:F.aid;return"<div style='background-image:url("+A.geticonurl(E,F.url=="http://sn")+");background-repeat:no-repeat;'><span style='padding-left: 23px;'>"+F.name+"</span></div>"}return""}function getDragHTML(D){var C="<div id='jstree-dragged' class='tree default'>";
if(D==null){var A=$.tree.focused().selected_arr;for(var B=0;B<A.length;B++){C+=getDragHTMLForNode(A[B])}}else{C+=getDragHTMLForNode(D)}C+="</div>";return C}function toggleUserCol(){if(isSafariNative()&&typeof(LPFromWebsite.ipad)=="function"){setcolvisibility("usernamecol",document.getElementById("usernamepropertext").className=="usercolhidden"?"1":"0");alert(gs("Please reload the page to view your changes."));return}var B=document.getElementsByName("usercol");for(var A=0;A<B.length;A++){B[A].className=B[A].className=="usercolhidden"?"usercolvisible":"usercolhidden";
if(A==0){setcolvisibility("usernamecol",B[A].className=="usercolhidden"?"0":"1")}}};